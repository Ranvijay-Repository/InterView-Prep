<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔹 Closures - Interview Prep Documentation</title>
    <meta name="description" content="Comprehensive guides for JavaScript, TypeScript, and React Native interview preparation">
    
    <!-- GitHub Pages compatible styling -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
        }
        
        .container {
            max-width: 100%;
        }
        
        h1, h2, h3, h4, h5, h6 {
            color: #2c3e50;
            margin-top: 2em;
            margin-bottom: 1em;
        }
        
        h1 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        h2 {
            border-bottom: 1px solid #ecf0f1;
            padding-bottom: 5px;
        }
        
        code {
            background-color: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
        }
        
        pre {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border-left: 4px solid #3498db;
        }
        
        pre code {
            background-color: transparent;
            padding: 0;
        }
        
        blockquote {
            border-left: 4px solid #3498db;
            margin: 0;
            padding-left: 20px;
            color: #666;
            font-style: italic;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 1em 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: left;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .navigation {
            background-color: #2c3e50;
            color: white;
            padding: 10px 0;
            margin-bottom: 20px;
        }
        
        .navigation a {
            color: white;
            text-decoration: none;
            margin-right: 20px;
        }
        
        .navigation a:hover {
            text-decoration: underline;
        }
        
        .breadcrumb {
            margin-bottom: 20px;
            color: #666;
        }
        
        .breadcrumb a {
            color: #3498db;
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            h2 {
                font-size: 1.4em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <nav class="navigation">
            <a href="/">Home</a>
            <a href="/Javascript/">JavaScript</a>
            <a href="/TypeScript/">TypeScript</a>
            <a href="/React-Native/">React Native</a>
        </nav>
        
        
        
        <main>
            <h1 id="-closures">🔹 Closures</h1>

<p><em>Understanding Functions That Remember Their Scope</em></p>

<link rel="stylesheet" href="../common-styles.css" />

<hr />

<h2 id="-table-of-contents">📚 Table of Contents</h2>
<ul>
  <li><a href="#what-are-closures">What are Closures?</a></li>
  <li><a href="#how-closures-work">How Closures Work</a></li>
  <li><a href="#closure-visualization">Closure Visualization</a></li>
  <li><a href="#use-cases">Use Cases</a></li>
  <li><a href="#detailed-examples">Detailed Examples</a></li>
  <li><a href="#common-pitfalls">Common Pitfalls</a></li>
  <li><a href="#best-practices">Best Practices</a></li>
  <li><a href="#key-points-for-interviews">Key Points for Interviews</a></li>
  <li><a href="#common-interview-questions">Common Interview Questions</a></li>
</ul>

<hr />

<h2 id="-what-are-closures">🎯 What are Closures?</h2>

<p>A closure is a function that has access to variables in its outer (enclosing) scope even after the outer function has returned. In other words, a closure “remembers” the environment in which it was created, including all the variables that were in scope at that time.</p>

<h3 id="-simple-analogy">🔍 Simple Analogy</h3>
<p>Think of a closure like a backpack:</p>
<ul>
  <li><strong>Function</strong> = The backpack</li>
  <li><strong>Outer variables</strong> = Items you put in the backpack</li>
  <li><strong>Memory</strong> = The backpack remembers what’s inside even when you’re far from home</li>
  <li><strong>Access</strong> = You can always reach into the backpack to get those items</li>
</ul>

<hr />

<h2 id="️-how-closures-work">⚙️ How Closures Work</h2>

<h3 id="-core-mechanism">🔑 Core Mechanism</h3>
<ol>
  <li><strong>Function Creation</strong>: A function is defined inside another function</li>
  <li><strong>Variable Capture</strong>: The inner function captures (remembers) variables from outer scope</li>
  <li><strong>Scope Retention</strong>: Even after outer function returns, inner function retains access</li>
  <li><strong>Memory Persistence</strong>: Variables stay in memory as long as closure exists</li>
</ol>

<h3 id="-lifecycle">🔄 Lifecycle</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌─────────────────────────────────────────────────────────────┐
│                    CLOSURE LIFECYCLE                        │
├─────────────────────────────────────────────────────────────┤
│  1. 🟢 Outer function executes                            │
│  2. 🟡 Inner function is created                          │
│  3. 🔴 Outer function returns                             │
│  4. 🟢 Inner function still has access to outer variables │
│  5. 🟡 Variables persist in memory                        │
│  6. 🔴 Closure can be called multiple times               │
└─────────────────────────────────────────────────────────────┘
</code></pre></div></div>

<hr />

<h2 id="️-closure-visualization">🗂️ Closure Visualization</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌─────────────────────────────────────────────────────────────┐
│                    CLOSURE STRUCTURE                        │
├─────────────────────────────────────────────────────────────┤
│  🌍 Global Scope                                           │
│  ├─ globalVar                                              │
│  └─ outerFunction()                                        │
│                                                             │
│  🏠 Outer Function Scope                                   │
│  ├─ outerVar                                               │
│  ├─ outerConst                                             │
│  └─ innerFunction() ← CLOSURE                              │
│      ├─ innerVar                                           │
│      ├─ Access to: outerVar, outerConst, globalVar        │
│      └─ Remembers outer scope even after outer returns     │
│                                                             │
│  🔗 Closure Chain: innerFunction → outerFunction → Global │
│  💾 Memory: outerVar and outerConst persist               │
└─────────────────────────────────────────────────────────────┘
</code></pre></div></div>

<h3 id="-memory-management">🔍 Memory Management</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌─────────────────────────────────────────────────────────────┐
│                CLOSURE MEMORY MANAGEMENT                    │
├─────────────────────────────────────────────────────────────┤
│  🟢 Variables in closure scope                            │
│  ├─ Stay in memory as long as closure exists              │
│  ├─ Cannot be garbage collected                           │
│  └─ Can lead to memory leaks if not managed               │
│                                                             │
│  🟡 Variables outside closure scope                       │
│  ├─ Can be garbage collected normally                     │
│  ├─ Don't interfere with closure memory                   │
│  └─ Closure only affects what it references               │
└─────────────────────────────────────────────────────────────┘
</code></pre></div></div>

<hr />

<h2 id="-use-cases">💡 Use Cases</h2>

<h3 id="1-data-privacy">1. <strong>Data Privacy</strong></h3>
<ul>
  <li>Encapsulate private variables</li>
  <li>Prevent external access to internal state</li>
  <li>Create private methods</li>
</ul>

<h3 id="2-function-factories">2. <strong>Function Factories</strong></h3>
<ul>
  <li>Create functions with preset parameters</li>
  <li>Generate specialized functions</li>
  <li>Configuration-based function creation</li>
</ul>

<h3 id="3-module-pattern">3. <strong>Module Pattern</strong></h3>
<ul>
  <li>Organize code into modules</li>
  <li>Hide implementation details</li>
  <li>Provide clean public interface</li>
</ul>

<h3 id="4-event-handlers">4. <strong>Event Handlers</strong></h3>
<ul>
  <li>Maintain state across events</li>
  <li>Access component data in callbacks</li>
  <li>Preserve context in asynchronous operations</li>
</ul>

<h3 id="5-memoization">5. <strong>Memoization</strong></h3>
<ul>
  <li>Cache expensive calculations</li>
  <li>Store results for reuse</li>
  <li>Optimize performance</li>
</ul>

<hr />

<h2 id="-detailed-examples">💻 Detailed Examples</h2>

<h3 id="example-1-basic-closure">Example 1: Basic Closure</h3>
<div style="position: relative;">
<button onclick="copyCode(this)" style="position: absolute; top: 10px; right: 10px; background: #007acc; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer; font-size: 12px;">📋 Copy</button>



```javascript
console.log("=== BASIC CLOSURE ===");

function outerFunction(outerParam) {
    // 🏠 Outer function scope
    let outerVar = "I'm from outer function";
    const outerConst = outerParam;
    
    function innerFunction(innerParam) {
        // 🏠 Inner function (closure)
        let innerVar = "I'm from inner function";
        
        console.log("=== Inner Function Access ===");
        console.log("innerVar:", innerVar);           // ✅ Own scope
        console.log("innerParam:", innerParam);       // ✅ Parameter
        console.log("outerVar:", outerVar);           // ✅ Outer scope (closure!)
        console.log("outerConst:", outerConst);       // ✅ Outer scope (closure!)
        console.log("outerParam:", outerParam);       // ✅ Outer parameter (closure!)
        
        return `Inner: ${innerVar}, Outer: ${outerVar}, Const: ${outerConst}`;
    }
    
    // Return the inner function (closure)
    return innerFunction;
}

// Create closure
const closure = outerFunction("passed parameter");

// Call closure (outer function has already returned!)
console.log("=== Calling Closure ===");
const result = closure("inner parameter");
console.log("Closure result:", result);

// Closure still has access to outer variables
console.log("=== Closure Memory ===");
console.log("Closure remembers outer variables even after outer function returned");
```


</div>

<h3 id="example-2-data-privacy-with-closures">Example 2: Data Privacy with Closures</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== DATA PRIVACY WITH CLOSURES ===</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">createCounter</span><span class="p">(</span><span class="nx">initialValue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 🏠 Private variables (not accessible from outside)</span>
    <span class="kd">let</span> <span class="nx">count</span> <span class="o">=</span> <span class="nx">initialValue</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">secretKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">super-secret-123</span><span class="dl">"</span><span class="p">;</span>
    
    <span class="c1">// 🏠 Private helper function</span>
    <span class="kd">function</span> <span class="nx">validateIncrement</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">value</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1">// 🏠 Return public interface</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="na">increment</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">validateIncrement</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">count</span> <span class="o">+=</span> <span class="nx">value</span><span class="p">;</span>
                <span class="k">return</span> <span class="nx">count</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Invalid increment value</span><span class="dl">"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>
        
        <span class="na">decrement</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">count</span> <span class="o">-=</span> <span class="nx">value</span><span class="p">;</span>
            <span class="k">return</span> <span class="nx">count</span><span class="p">;</span>
        <span class="p">},</span>
        
        <span class="na">getValue</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">count</span><span class="p">;</span>
        <span class="p">},</span>
        
        <span class="na">reset</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">count</span> <span class="o">=</span> <span class="nx">initialValue</span><span class="p">;</span>
        <span class="p">},</span>
        
        <span class="c1">// 🚫 Cannot access private variables</span>
        <span class="c1">// getSecretKey: function() { return secretKey; } // Would expose private data</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="c1">// Create counter instance</span>
<span class="kd">const</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nx">createCounter</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Using Counter ===</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Initial value:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">counter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">());</span>     <span class="c1">// 10</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">After increment:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">counter</span><span class="p">.</span><span class="nx">increment</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span> <span class="c1">// 15</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">After decrement:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">counter</span><span class="p">.</span><span class="nx">decrement</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span> <span class="c1">// 12</span>

<span class="c1">// Try to access private variables</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Privacy Test ===</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">counter.count:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">counter</span><span class="p">.</span><span class="nx">count</span><span class="p">);</span>         <span class="c1">// undefined</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">counter.secretKey:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">counter</span><span class="p">.</span><span class="nx">secretKey</span><span class="p">);</span> <span class="c1">// undefined</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">counter.validateIncrement:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">counter</span><span class="p">.</span><span class="nx">validateIncrement</span><span class="p">);</span> <span class="c1">// undefined</span>

<span class="c1">// Private variables are truly private!</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Private variables are completely hidden from outside access</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="example-3-function-factory-with-closures">Example 3: Function Factory with Closures</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== FUNCTION FACTORY WITH CLOSURES ===</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">createGreeter</span><span class="p">(</span><span class="nx">greeting</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 🏠 Closure captures the greeting parameter</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">`</span><span class="p">${</span><span class="nx">greeting</span><span class="p">}</span><span class="s2">, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">!`</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="c1">// Create specialized greeters</span>
<span class="kd">const</span> <span class="nx">sayHello</span> <span class="o">=</span> <span class="nx">createGreeter</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hello</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">sayGoodbye</span> <span class="o">=</span> <span class="nx">createGreeter</span><span class="p">(</span><span class="dl">"</span><span class="s2">Goodbye</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">sayGoodMorning</span> <span class="o">=</span> <span class="nx">createGreeter</span><span class="p">(</span><span class="dl">"</span><span class="s2">Good morning</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Using Greeter Functions ===</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sayHello</span><span class="p">(</span><span class="dl">"</span><span class="s2">John</span><span class="dl">"</span><span class="p">));</span>        <span class="c1">// "Hello, John!"</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sayGoodbye</span><span class="p">(</span><span class="dl">"</span><span class="s2">Jane</span><span class="dl">"</span><span class="p">));</span>      <span class="c1">// "Goodbye, Jane!"</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sayGoodMorning</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bob</span><span class="dl">"</span><span class="p">));</span>   <span class="c1">// "Good morning, Bob!"</span>

<span class="c1">// Each closure remembers its own greeting</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Closure Memory ===</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">sayHello closure remembers: 'Hello'</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">sayGoodbye closure remembers: 'Goodbye'</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">sayGoodMorning closure remembers: 'Good morning'</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// More complex factory</span>
<span class="kd">function</span> <span class="nx">createCalculator</span><span class="p">(</span><span class="nx">operation</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="p">(</span><span class="nx">operation</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">case</span> <span class="dl">'</span><span class="s1">add</span><span class="dl">'</span><span class="p">:</span>
                <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
            <span class="k">case</span> <span class="dl">'</span><span class="s1">subtract</span><span class="dl">'</span><span class="p">:</span>
                <span class="k">return</span> <span class="nx">a</span> <span class="o">-</span> <span class="nx">b</span><span class="p">;</span>
            <span class="k">case</span> <span class="dl">'</span><span class="s1">multiply</span><span class="dl">'</span><span class="p">:</span>
                <span class="k">return</span> <span class="nx">a</span> <span class="o">*</span> <span class="nx">b</span><span class="p">;</span>
            <span class="k">case</span> <span class="dl">'</span><span class="s1">divide</span><span class="dl">'</span><span class="p">:</span>
                <span class="k">return</span> <span class="nx">b</span> <span class="o">!==</span> <span class="mi">0</span> <span class="p">?</span> <span class="nx">a</span> <span class="o">/</span> <span class="nx">b</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">Error: Division by zero</span><span class="dl">'</span><span class="p">;</span>
            <span class="nl">default</span><span class="p">:</span>
                <span class="k">return</span> <span class="dl">'</span><span class="s1">Error: Unknown operation</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">add</span> <span class="o">=</span> <span class="nx">createCalculator</span><span class="p">(</span><span class="dl">'</span><span class="s1">add</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">multiply</span> <span class="o">=</span> <span class="nx">createCalculator</span><span class="p">(</span><span class="dl">'</span><span class="s1">multiply</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">divide</span> <span class="o">=</span> <span class="nx">createCalculator</span><span class="p">(</span><span class="dl">'</span><span class="s1">divide</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Calculator Functions ===</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">add(5, 3):</span><span class="dl">"</span><span class="p">,</span> <span class="nx">add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span>           <span class="c1">// 8</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">multiply(4, 6):</span><span class="dl">"</span><span class="p">,</span> <span class="nx">multiply</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">));</span> <span class="c1">// 24</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">divide(10, 2):</span><span class="dl">"</span><span class="p">,</span> <span class="nx">divide</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>   <span class="c1">// 5</span>
</code></pre></div></div>

<h3 id="example-4-module-pattern-with-closures">Example 4: Module Pattern with Closures</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== MODULE PATTERN WITH CLOSURES ===</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">userModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// 🏠 Private variables and functions</span>
    <span class="kd">let</span> <span class="nx">users</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">let</span> <span class="nx">nextId</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    
    <span class="kd">function</span> <span class="nx">generateId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">nextId</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kd">function</span> <span class="nx">validateUser</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">user</span><span class="p">.</span><span class="nx">name</span> <span class="o">&amp;&amp;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">email</span> <span class="o">&amp;&amp;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">age</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kd">function</span> <span class="nx">findUserById</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">users</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">user</span> <span class="o">=&gt;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="c1">// 🏠 Return public interface</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="na">addUser</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">name</span> <span class="o">||</span> <span class="o">!</span><span class="nx">email</span> <span class="o">||</span> <span class="nx">age</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Invalid user data</span><span class="dl">"</span><span class="p">);</span>
            <span class="p">}</span>
            
            <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="p">{</span>
                <span class="na">id</span><span class="p">:</span> <span class="nx">generateId</span><span class="p">(),</span>
                <span class="nx">name</span><span class="p">,</span>
                <span class="nx">email</span><span class="p">,</span>
                <span class="nx">age</span><span class="p">,</span>
                <span class="na">createdAt</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
            <span class="p">};</span>
            
            <span class="nx">users</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">user</span><span class="p">;</span>
        <span class="p">},</span>
        
        <span class="na">getUser</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">findUserById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">User not found</span><span class="dl">"</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="p">{</span> <span class="p">...</span><span class="nx">user</span> <span class="p">};</span> <span class="c1">// Return copy, not reference</span>
        <span class="p">},</span>
        
        <span class="na">getAllUsers</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">users</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">user</span> <span class="o">=&gt;</span> <span class="p">({</span> <span class="p">...</span><span class="nx">user</span> <span class="p">}));</span> <span class="c1">// Return copies</span>
        <span class="p">},</span>
        
        <span class="na">updateUser</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">updates</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">findUserById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">User not found</span><span class="dl">"</span><span class="p">);</span>
            <span class="p">}</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="nx">updates</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="nx">user</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">updates</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">updates</span><span class="p">.</span><span class="nx">email</span><span class="p">)</span> <span class="nx">user</span><span class="p">.</span><span class="nx">email</span> <span class="o">=</span> <span class="nx">updates</span><span class="p">.</span><span class="nx">email</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">updates</span><span class="p">.</span><span class="nx">age</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="nx">user</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">updates</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span>
            
            <span class="k">return</span> <span class="p">{</span> <span class="p">...</span><span class="nx">user</span> <span class="p">};</span>
        <span class="p">},</span>
        
        <span class="na">deleteUser</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">users</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">(</span><span class="nx">user</span> <span class="o">=&gt;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">User not found</span><span class="dl">"</span><span class="p">);</span>
            <span class="p">}</span>
            
            <span class="kd">const</span> <span class="nx">deletedUser</span> <span class="o">=</span> <span class="nx">users</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="k">return</span> <span class="p">{</span> <span class="p">...</span><span class="nx">deletedUser</span> <span class="p">};</span>
        <span class="p">},</span>
        
        <span class="na">getUserCount</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">users</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">})();</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Using User Module ===</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// Add users</span>
<span class="kd">const</span> <span class="nx">user1</span> <span class="o">=</span> <span class="nx">userModule</span><span class="p">.</span><span class="nx">addUser</span><span class="p">(</span><span class="dl">"</span><span class="s2">John Doe</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">john@example.com</span><span class="dl">"</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">user2</span> <span class="o">=</span> <span class="nx">userModule</span><span class="p">.</span><span class="nx">addUser</span><span class="p">(</span><span class="dl">"</span><span class="s2">Jane Smith</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">jane@example.com</span><span class="dl">"</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Added users:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">user1</span><span class="p">,</span> <span class="nx">user2</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">User count:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">userModule</span><span class="p">.</span><span class="nx">getUserCount</span><span class="p">());</span>

<span class="c1">// Get user</span>
<span class="kd">const</span> <span class="nx">retrievedUser</span> <span class="o">=</span> <span class="nx">userModule</span><span class="p">.</span><span class="nx">getUser</span><span class="p">(</span><span class="nx">user1</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Retrieved user:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">retrievedUser</span><span class="p">);</span>

<span class="c1">// Update user</span>
<span class="kd">const</span> <span class="nx">updatedUser</span> <span class="o">=</span> <span class="nx">userModule</span><span class="p">.</span><span class="nx">updateUser</span><span class="p">(</span><span class="nx">user1</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="p">{</span> <span class="na">age</span><span class="p">:</span> <span class="mi">31</span> <span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Updated user:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">updatedUser</span><span class="p">);</span>

<span class="c1">// Private variables are not accessible</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Privacy Test ===</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">users:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">userModule</span><span class="p">.</span><span class="nx">users</span><span class="p">);</span>           <span class="c1">// undefined</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">nextId:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">userModule</span><span class="p">.</span><span class="nx">nextId</span><span class="p">);</span>         <span class="c1">// undefined</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">generateId:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">userModule</span><span class="p">.</span><span class="nx">generateId</span><span class="p">);</span> <span class="c1">// undefined</span>
</code></pre></div></div>

<h3 id="example-5-event-handlers-and-closures">Example 5: Event Handlers and Closures</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== EVENT HANDLERS AND CLOSURES ===</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// Simulating DOM elements</span>
<span class="kd">const</span> <span class="nx">button1</span> <span class="o">=</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">btn1</span><span class="dl">"</span><span class="p">,</span> <span class="na">text</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Button 1</span><span class="dl">"</span> <span class="p">};</span>
<span class="kd">const</span> <span class="nx">button2</span> <span class="o">=</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">btn2</span><span class="dl">"</span><span class="p">,</span> <span class="na">text</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Button 2</span><span class="dl">"</span> <span class="p">};</span>

<span class="c1">// Function to create event handlers with closures</span>
<span class="kd">function</span> <span class="nx">createButtonHandler</span><span class="p">(</span><span class="nx">buttonId</span><span class="p">,</span> <span class="nx">buttonText</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 🏠 Closure captures buttonId and buttonText</span>
    <span class="kd">let</span> <span class="nx">clickCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">clickCount</span><span class="o">++</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`=== Button Click Event ===`</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Button ID: </span><span class="p">${</span><span class="nx">buttonId</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Button Text: </span><span class="p">${</span><span class="nx">buttonText</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Click Count: </span><span class="p">${</span><span class="nx">clickCount</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Event Type: </span><span class="p">${</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
        
        <span class="c1">// Closure remembers clickCount between calls</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">clickCount</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">First click!</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">clickCount</span> <span class="o">===</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">5th click! Special message!</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="c1">// Create handlers for different buttons</span>
<span class="kd">const</span> <span class="nx">handler1</span> <span class="o">=</span> <span class="nx">createButtonHandler</span><span class="p">(</span><span class="dl">"</span><span class="s2">btn1</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Button 1</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">handler2</span> <span class="o">=</span> <span class="nx">createButtonHandler</span><span class="p">(</span><span class="dl">"</span><span class="s2">btn2</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Button 2</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Simulating Button Clicks ===</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// Simulate clicks on button 1</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Clicking Button 1:</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">handler1</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">click</span><span class="dl">"</span> <span class="p">});</span>
<span class="nx">handler1</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">click</span><span class="dl">"</span> <span class="p">});</span>
<span class="nx">handler1</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">click</span><span class="dl">"</span> <span class="p">});</span>

<span class="c1">// Simulate clicks on button 2</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Clicking Button 2:</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">handler2</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">click</span><span class="dl">"</span> <span class="p">});</span>
<span class="nx">handler2</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">click</span><span class="dl">"</span> <span class="p">});</span>

<span class="c1">// Each handler maintains its own clickCount</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Closure Independence ===</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Each button handler has its own click count</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Handler 1 and Handler 2 are completely independent</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="example-6-memoization-with-closures">Example 6: Memoization with Closures</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== MEMOIZATION WITH CLOSURES ===</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">createMemoizedFunction</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 🏠 Private cache object</span>
    <span class="kd">const</span> <span class="nx">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
    
    <span class="k">return</span> <span class="kd">function</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Create cache key from arguments</span>
        <span class="kd">const</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
        
        <span class="c1">// Check if result is already cached</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">cache</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cache hit for:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">key</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">cache</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="c1">// Calculate result and cache it</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cache miss for:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">key</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
        <span class="nx">cache</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
        
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="c1">// Expensive calculation function</span>
<span class="kd">function</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="nx">n</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Create memoized version</span>
<span class="kd">const</span> <span class="nx">memoizedFibonacci</span> <span class="o">=</span> <span class="nx">createMemoizedFunction</span><span class="p">(</span><span class="nx">fibonacci</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Testing Memoization ===</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// First call (cache miss)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">time</span><span class="p">(</span><span class="dl">"</span><span class="s2">First call</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">result1</span> <span class="o">=</span> <span class="nx">memoizedFibonacci</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">timeEnd</span><span class="p">(</span><span class="dl">"</span><span class="s2">First call</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Result 1:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">result1</span><span class="p">);</span>

<span class="c1">// Second call with same input (cache hit)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">time</span><span class="p">(</span><span class="dl">"</span><span class="s2">Second call</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">result2</span> <span class="o">=</span> <span class="nx">memoizedFibonacci</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">timeEnd</span><span class="p">(</span><span class="dl">"</span><span class="s2">Second call</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Result 2:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">result2</span><span class="p">);</span>

<span class="c1">// Different input (cache miss)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">time</span><span class="p">(</span><span class="dl">"</span><span class="s2">Different input</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">result3</span> <span class="o">=</span> <span class="nx">memoizedFibonacci</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">timeEnd</span><span class="p">(</span><span class="dl">"</span><span class="s2">Different input</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Result 3:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">result3</span><span class="p">);</span>

<span class="c1">// Same input again (cache hit)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">time</span><span class="p">(</span><span class="dl">"</span><span class="s2">Same input again</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">result4</span> <span class="o">=</span> <span class="nx">memoizedFibonacci</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">timeEnd</span><span class="p">(</span><span class="dl">"</span><span class="s2">Same input again</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Result 4:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">result4</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Memoization Benefits ===</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">1. Expensive calculations are cached</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">2. Subsequent calls with same input are fast</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">3. Cache persists between function calls</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">4. Memory usage increases with cache size</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<hr />

<h2 id="️-common-pitfalls">⚠️ Common Pitfalls</h2>

<h3 id="pitfall-1-creating-closures-in-loops">Pitfall 1: Creating Closures in Loops</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== PITFALL 1: CLOSURES IN LOOPS ===</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// ❌ Problem: All closures reference the same variable</span>
<span class="kd">function</span> <span class="nx">createProblematicHandlers</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">handlers</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">handlers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Button</span><span class="dl">"</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="dl">"</span><span class="s2">clicked</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// All print "Button 3 clicked"</span>
        <span class="p">});</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">handlers</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">problematicHandlers</span> <span class="o">=</span> <span class="nx">createProblematicHandlers</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Problematic Handlers ===</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">problematicHandlers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">handler</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Handler </span><span class="p">${</span><span class="nx">index</span><span class="p">}</span><span class="s2">:`</span><span class="p">);</span>
    <span class="nx">handler</span><span class="p">();</span>
<span class="p">});</span>

<span class="c1">// ✅ Solution 1: Use let (block scope)</span>
<span class="kd">function</span> <span class="nx">createFixedHandlers1</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">handlers</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">handlers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Button</span><span class="dl">"</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="dl">"</span><span class="s2">clicked</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// Each prints different value</span>
        <span class="p">});</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">handlers</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">fixedHandlers1</span> <span class="o">=</span> <span class="nx">createFixedHandlers1</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Fixed Handlers (let) ===</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">fixedHandlers1</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">handler</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Handler </span><span class="p">${</span><span class="nx">index</span><span class="p">}</span><span class="s2">:`</span><span class="p">);</span>
    <span class="nx">handler</span><span class="p">();</span>
<span class="p">});</span>

<span class="c1">// ✅ Solution 2: IIFE (Immediately Invoked Function Expression)</span>
<span class="kd">function</span> <span class="nx">createFixedHandlers2</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">handlers</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">handlers</span><span class="p">.</span><span class="nx">push</span><span class="p">((</span><span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Button</span><span class="dl">"</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="dl">"</span><span class="s2">clicked</span><span class="dl">"</span><span class="p">);</span>
            <span class="p">};</span>
        <span class="p">})(</span><span class="nx">i</span><span class="p">));</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">handlers</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">fixedHandlers2</span> <span class="o">=</span> <span class="nx">createFixedHandlers2</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== Fixed Handlers (IIFE) ===</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">fixedHandlers2</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">handler</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Handler </span><span class="p">${</span><span class="nx">index</span><span class="p">}</span><span class="s2">:`</span><span class="p">);</span>
    <span class="nx">handler</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="pitfall-2-memory-leaks">Pitfall 2: Memory Leaks</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== PITFALL 2: MEMORY LEAKS ===</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// ❌ Problem: Closure holds reference to large object</span>
<span class="kd">function</span> <span class="nx">createMemoryLeak</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">largeData</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1000000</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Large data length:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">largeData</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="c1">// largeData stays in memory even if we don't need it</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">leakyClosure</span> <span class="o">=</span> <span class="nx">createMemoryLeak</span><span class="p">();</span>

<span class="c1">// ✅ Solution: Only capture what you need</span>
<span class="kd">function</span> <span class="nx">createMemoryEfficient</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">largeData</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1000000</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Only capture the length, not the entire array</span>
        <span class="kd">const</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">largeData</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Data length:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">length</span><span class="p">);</span>
        <span class="c1">// largeData can be garbage collected</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">efficientClosure</span> <span class="o">=</span> <span class="nx">createMemoryEfficient</span><span class="p">();</span>
</code></pre></div></div>

<hr />

<h2 id="-best-practices">✅ Best Practices</h2>

<h3 id="1-only-capture-what-you-need">1. Only Capture What You Need</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== BEST PRACTICE 1: CAPTURE ONLY WHAT YOU NEED ===</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// ❌ Don't capture large objects unnecessarily</span>
<span class="kd">function</span> <span class="nx">badPractice</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">hugeObject</span> <span class="o">=</span> <span class="p">{</span> <span class="cm">/* lots of data */</span> <span class="p">};</span>
    
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Only need one property</span>
        <span class="k">return</span> <span class="nx">hugeObject</span><span class="p">.</span><span class="nx">someProperty</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="c1">// ✅ Only capture what you actually use</span>
<span class="kd">function</span> <span class="nx">goodPractice</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">hugeObject</span> <span class="o">=</span> <span class="p">{</span> <span class="cm">/* lots of data */</span> <span class="p">};</span>
    <span class="kd">const</span> <span class="nx">neededProperty</span> <span class="o">=</span> <span class="nx">hugeObject</span><span class="p">.</span><span class="nx">someProperty</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">neededProperty</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="2-use-closures-for-data-privacy">2. Use Closures for Data Privacy</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== BEST PRACTICE 2: USE CLOSURES FOR PRIVACY ===</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// ✅ Module pattern for data privacy</span>
<span class="kd">const</span> <span class="nx">privateModule</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">privateData</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">secret</span><span class="dl">"</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="p">{</span>
        <span class="na">getData</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">privateData</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="na">setData</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newData</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">privateData</span> <span class="o">=</span> <span class="nx">newData</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">})();</span>

<span class="c1">// Private data is truly private</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Public access:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">privateModule</span><span class="p">.</span><span class="nx">getData</span><span class="p">());</span>
<span class="c1">// console.log("Private access:", privateModule.privateData); // undefined</span>
</code></pre></div></div>

<h3 id="3-be-mindful-of-memory">3. Be Mindful of Memory</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">=== BEST PRACTICE 3: BE MINDFUL OF MEMORY ===</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// ✅ Clear references when done</span>
<span class="kd">function</span> <span class="nx">createTemporaryClosure</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">temporary data</span><span class="dl">"</span><span class="p">;</span>
    
    <span class="kd">const</span> <span class="nx">closure</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">};</span>
    
    <span class="c1">// Clear reference when done</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="na">use</span><span class="p">:</span> <span class="nx">closure</span><span class="p">,</span>
        <span class="na">cleanup</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="c1">// Clear the closure reference</span>
            <span class="nx">closure</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="-key-points-for-interviews">🎯 Key Points for Interviews</h2>

<h3 id="-core-concepts">🔑 Core Concepts</h3>
<ol>
  <li><strong>Closure Definition</strong>: Function that remembers its outer scope</li>
  <li><strong>Scope Retention</strong>: Variables persist even after outer function returns</li>
  <li><strong>Memory Management</strong>: Closures can prevent garbage collection</li>
  <li><strong>Data Privacy</strong>: Excellent for encapsulation and hiding implementation</li>
  <li><strong>Function Factory</strong>: Create specialized functions with preset parameters</li>
</ol>

<h3 id="-common-mistakes">🚨 Common Mistakes</h3>
<ol>
  <li><strong>Creating closures in loops with var</strong></li>
  <li><strong>Memory leaks from capturing large objects</strong></li>
  <li><strong>Not understanding closure scope chain</strong></li>
  <li><strong>Forgetting that closures persist in memory</strong></li>
</ol>

<h3 id="-advanced-concepts">💡 Advanced Concepts</h3>
<ol>
  <li><strong>Module Pattern</strong>: Using closures for module organization</li>
  <li><strong>Currying</strong>: Partial function application with closures</li>
  <li><strong>Memoization</strong>: Caching with closures</li>
  <li><strong>Event Handling</strong>: Maintaining state across events</li>
</ol>

<hr />

<h2 id="-common-interview-questions">❓ Common Interview Questions</h2>

<h3 id="q-what-is-a-closure-in-javascript">Q: What is a closure in JavaScript?</h3>
<p><strong>A:</strong> A closure is a function that has access to variables in its outer (enclosing) scope even after the outer function has returned. The inner function “remembers” the environment in which it was created.</p>

<p><strong>Key Points:</strong></p>
<ul>
  <li>Function defined inside another function</li>
  <li>Captures variables from outer scope</li>
  <li>Variables persist in memory</li>
  <li>Can access outer variables even after outer function returns</li>
</ul>

<h3 id="q-how-do-closures-work">Q: How do closures work?</h3>
<p><strong>A:</strong> Closures work through JavaScript’s scope chain mechanism:</p>

<p><strong>Process:</strong></p>
<ol>
  <li>Inner function is created inside outer function</li>
  <li>Inner function captures variables from outer scope</li>
  <li>Outer function returns inner function</li>
  <li>Inner function retains access to captured variables</li>
  <li>Variables stay in memory as long as closure exists</li>
</ol>

<p><strong>Example:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">outer</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    
    <span class="kd">function</span> <span class="nx">inner</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">x</span><span class="p">;</span> <span class="c1">// Captures x from outer scope</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">inner</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">closure</span> <span class="o">=</span> <span class="nx">outer</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">closure</span><span class="p">());</span> <span class="c1">// 10 (x is still accessible)</span>
</code></pre></div></div>

<h3 id="q-what-are-the-main-use-cases-for-closures">Q: What are the main use cases for closures?</h3>
<p><strong>A:</strong> Closures are used for:</p>

<p><strong>1. Data Privacy:</strong></p>
<ul>
  <li>Encapsulate private variables</li>
  <li>Hide implementation details</li>
  <li>Create private methods</li>
</ul>

<p><strong>2. Function Factories:</strong></p>
<ul>
  <li>Generate specialized functions</li>
  <li>Preset parameters</li>
  <li>Configuration-based functions</li>
</ul>

<p><strong>3. Module Pattern:</strong></p>
<ul>
  <li>Organize code into modules</li>
  <li>Provide clean public interface</li>
  <li>Maintain private state</li>
</ul>

<p><strong>4. Event Handlers:</strong></p>
<ul>
  <li>Maintain state across events</li>
  <li>Access component data</li>
  <li>Preserve context</li>
</ul>

<h3 id="q-how-can-closures-cause-memory-leaks">Q: How can closures cause memory leaks?</h3>
<p><strong>A:</strong> Closures can cause memory leaks by:</p>

<p><strong>Mechanism:</strong></p>
<ul>
  <li>Variables captured by closure stay in memory</li>
  <li>Cannot be garbage collected while closure exists</li>
  <li>Large objects captured unnecessarily consume memory</li>
</ul>

<p><strong>Examples:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ❌ Memory leak: capturing large object</span>
<span class="kd">function</span> <span class="nx">leaky</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">hugeData</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1000000</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hugeData</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span> <span class="c1">// Captures entire array</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="c1">// ✅ Efficient: only capture what you need</span>
<span class="kd">function</span> <span class="nx">efficient</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">hugeData</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1000000</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">hugeData</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span> <span class="c1">// Only captures number</span>
    <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="q-how-do-you-fix-the-closure-in-loop-problem">Q: How do you fix the closure-in-loop problem?</h3>
<p><strong>A:</strong> The closure-in-loop problem occurs when all closures reference the same variable. Here are solutions:</p>

<p><strong>Problem:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span> <span class="mi">100</span><span class="p">);</span> <span class="c1">// All print 3</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Solutions:</strong></p>

<p><strong>1. Use let (block scope):</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span> <span class="mi">100</span><span class="p">);</span> <span class="c1">// 0, 1, 2</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>2. IIFE (Immediately Invoked Function Expression):</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">index</span><span class="p">),</span> <span class="mi">100</span><span class="p">);</span>
    <span class="p">})(</span><span class="nx">i</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>3. bind() method:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">i</span><span class="p">),</span> <span class="mi">100</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="-practice-exercises">🧪 Practice Exercises</h2>

<h3 id="exercise-1-basic-closure-understanding">Exercise 1: Basic Closure Understanding</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Exercise 1: Predict the output</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">createCounter</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">count</span><span class="o">++</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">count</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">counter1</span> <span class="o">=</span> <span class="nx">createCounter</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">counter2</span> <span class="o">=</span> <span class="nx">createCounter</span><span class="p">();</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">counter1</span><span class="p">());</span> <span class="c1">// What will this print?</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">counter1</span><span class="p">());</span> <span class="c1">// What will this print?</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">counter2</span><span class="p">());</span> <span class="c1">// What will this print?</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">counter1</span><span class="p">());</span> <span class="c1">// What will this print?</span>
</code></pre></div></div>

<h3 id="exercise-2-closure-in-loop-fix">Exercise 2: Closure in Loop Fix</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Exercise 2: Fix the closure in loop</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// Fix this code so each button prints its correct index</span>
<span class="kd">function</span> <span class="nx">createButtons</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">buttons</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">buttons</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Button</span><span class="dl">"</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="dl">"</span><span class="s2">clicked</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">buttons</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Your fix here...</span>
</code></pre></div></div>

<h3 id="exercise-3-module-pattern-implementation">Exercise 3: Module Pattern Implementation</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Exercise 3: Implement a module pattern</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// Create a bank account module with private balance</span>
<span class="c1">// Public methods: deposit, withdraw, getBalance</span>
<span class="c1">// Private variables: balance, transactionHistory</span>

<span class="c1">// Your implementation here...</span>
</code></pre></div></div>

<hr />

<h2 id="-additional-resources">📚 Additional Resources</h2>

<ul>
  <li><strong>MDN Web Docs</strong>: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">Closures</a></li>
  <li><strong>JavaScript.info</strong>: <a href="https://javascript.info/closure">Variable Scope and Closure</a></li>
  <li><strong>ECMAScript Specification</strong>: <a href="https://tc39.es/ecma262/#sec-lexical-environments">Lexical Environments</a></li>
</ul>

<hr />

<h2 id="-navigation">🧭 Navigation</h2>

<div class="navigation">
    <a href="./03-Scope-Lexical-Scope.md" class="nav-link prev">⬅️ Previous: Scope &amp; Lexical Scope</a>
    <a href="./05-Temporal-Dead-Zone.md" class="nav-link next">Next: Temporal Dead Zone (TDZ) ➡️</a>
</div>

<hr />

<h2 id="-copy-code-functionality">📋 Copy Code Functionality</h2>

<script src="../common-scripts.js"></script>

<p><em>Last updated: December 2024</em></p>

        </main>
        
        <footer style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #ecf0f1; color: #666; text-align: center;">
            <p>Interview Prep Documentation - Built with Jekyll</p>
        </footer>
    </div>
</body>
</html>
